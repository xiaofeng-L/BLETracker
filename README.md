# BLETracker_proverif
## File explanation

The **model** folder contains our models implemented in SAPIC+.

- **model/Apple_initialization.spthy** contains the model of Apple initialization protocol.
- **model/P12_P13_Apple_broadcast.spthy** contains the model of the Apple location tracking protocol for anonymity.
- **model/Apple_location.spthy** contains the model of Apple location tracking protocol.
- **model/Apple_initialization_Authentication.spthy** contains the model of Apple initialization protocol for authentication.

- **model/Samsung_initialization_Confidentiality.spthy** contains the model of Samsung initialization protocol.
- **model/Samsung_initialization_Authentication.spthy** contains the model of the Samsung broadcast protocol (BLE advertisement address).
- **model/Samsung_initialization_Authentication_fixed_V1.spthy** contains the model of the Samsung broadcast protocol (BLE advertisement address).
- **model/P2_Samsung_broadcast_ID.spthy** contains the model of the location tracking protocol for the anonymity of SmartTag's ID.
- **model/P5_Samsung_broadcast_AdvAddr.spthy** contains the model of the Samsung location tracking protocol for the anonymity of SmartTag's BLE MAC address.
- **model/P6_Samsung_broadcast_pubkey.pv** contains the model of the Samsung location tracking protocol for the anonymity of SmartTag's public key.
- **model/Samsung_location_E2E.spthy** contains the model of Samsung location tracking protocol (E2E).
- **model/Samsung_location_NoE2E.spthy** contains the model of Samsung location tracking protocol (NoE2E).

- **model/C1_Apple_pair_fixed.pv** contains the model of the fixed Apple initialization protocol.
- **model/C1_Samsung_pair_fixed.pv** contains the model of the fixed Samsung initialization protocol.


The ***.sh** scripts under the root folder contain the verification scripts of the corresponding protocol and the fixed protocol.
- **TODO**

The **output** folder contains all the results generated by ProVerif when detecting the violations.
We identified three new vulnerabilities by a formal analysis and rediscovered three vulnerabilities found by reverse engineering.
- ****

The **attack_traces** folder contains all the attack traces generated by ProVerif or Tamarin when detecting violations.

## How to run

Please run the model using ProVerif v2.04 -- the version we have tested our model with. We did not test the model with other versions of ProfVerif

Simply execute each script (`*.sh`) to verify the corresponding protocol.

Or run the script `run_all.sh` to verify all protocols.
