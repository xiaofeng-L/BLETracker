# BLETracker_proverif
## File explanation

The **model** folder contains the modular-design models implemented in ProVerif.

- **model/C1_Apple_pair.pv** contains the model of Apple initialization protocol.
- **model/A1_Apple_broadcast.pv** contains the model of the Apple broadcast protocol (public key).
- **model/C2_Apple_location.pv** contains the model of Apple location tracking protocol.

- **model/C1_Samsung_pair.pv** contains the model of Samsung initialization protocol.
- **model/A2_Samsung_broadcast.pv** contains the model of the Samsung broadcast protocol (BLE advertisement address).
- **model/A3_Samsung_broadcast.pv** contains the model of the Samsung broadcast protocol (ID).
- **model/A4_Samsung_broadcast.pv** contains the model of the Samsung broadcast protocol (signature).
- **model/A5_Samsung_broadcast.pv** contains the model of the Samsung broadcast protocol (public key).
- **model/C2_Samsung_location.pv** contains the model of Samsung location tracking protocol (E2E & NoE2E).

- **model/C1_Apple_pair_fixed.pv** contains the model of the fixed Apple initialization protocol.
- **model/C1_Samsung_pair_fixed.pv** contains the model of the fixed Samsung initialization protocol.


The ***.sh** scripts under the root folder contains the verification scripts of the corresponding protocol and the fixed protocol.

- verify_a_l**.sh** verifies Apple location tracking protocol.
- verify_a_p**.sh** verifies Apple initialization protocol and the fixed Apple initialization protocol.
- verify_s_l**.sh** verifies different mode of Samsung location tracking protocol (E2E and NoE2E).
- verify_s_p**.sh** verifies Samsung initialization protocol and the fixed Samsung initialization protocol.
- verify_anonymity**.sh** verifies the anonymity of the Apple broadcast protocol and the Samsung broadcast protocol.

The **output** folder contains all the results generated by ProVerif when detecting the violations.

The **attack_traces** folder contains all the attack traces generated by ProVerif when detecting the violations.

## How to run

Please run the model using ProVerif v2.04 -- the version we have tested our model with. We did not test the model with other versions of ProfVerif

Simply execute each script (`*.sh`) to verify the corresponding protocol.

Or run the script `run_all.sh` to verify all protocols.
