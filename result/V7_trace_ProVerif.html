<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
                      <html>
                    <head>
                    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
                    <title>ProVerif: trace for query 1</title>
                    <link rel="stylesheet" href="cssproverif.css">
                                                                           </head>
                                                                         <body>
                                                                         <H1>Trace</H1>
<span class="keyword">new</span> <span class="name">s_1</span>: <span class="type">bitstring</span> creating <span class="name">s_3</span> at <a href="process_1.html#occ1" target="process" class="occ">{1}</a><br>
<br>
<span class="keyword">new</span> <span class="name">sec_ch_1</span>: <span class="type">channel</span> creating <span class="name">sec_ch</span> at <a href="process_1.html#occ2" target="process" class="occ">{2}</a><br>
<br>
<span class="keyword">new</span> <span class="name">pri_a_1</span>: <span class="type">bitstring</span> creating <span class="name">pri_a</span> at <a href="process_1.html#occ100" target="process" class="occ">{100}</a><br>
<br>
<span class="keyword">out</span>(<span class="name">att</span>, <span class="fun"></span>(<span class="var">~M</span>,<span class="var">~M_1</span>)) with <span class="var">~M</span> = <span class="fun">exp</span>(<span class="fun">g</span>,<span class="name">pri_a</span>), <span class="var">~M_1</span> = <span class="name">c_p</span> at <a href="process_1.html#occ102" target="process" class="occ">{102}</a><br>
<br>
<span class="keyword">new</span> <span class="name">UUID</span>: <span class="type">bitstring</span> creating <span class="name">UUID_2</span> at <a href="process_1.html#occ26" target="process" class="occ">{26}</a><br>
<br>
<span class="keyword">new</span> <span class="name">pri_b_1</span>: <span class="type">bitstring</span> creating <span class="name">pri_b</span> at <a href="process_1.html#occ27" target="process" class="occ">{27}</a><br>
<br>
<span class="keyword">new</span> <span class="name">iCloudldentifier_1</span>: <span class="type">bitstring</span> creating <span class="name">iCloudldentifier_3</span> at <a href="process_1.html#occ3" target="process" class="occ">{3}</a><br>
<br>
<span class="keyword">in</span>(<span class="name">att</span>, <span class="fun"></span>(<span class="fun">g</span>,<span class="name">c_p</span>)) at <a href="process_1.html#occ29" target="process" class="occ">{29}</a><br>
<br>
<span class="keyword">out</span>(<span class="name">att</span>, <span class="fun"></span>(<span class="var">~M_2</span>,<span class="var">~M_3</span>)) with <span class="var">~M_2</span> = <span class="fun">exp</span>(<span class="fun">g</span>,<span class="name">pri_b</span>), <span class="var">~M_3</span> = <span class="name">c_p</span> at <a href="process_1.html#occ30" target="process" class="occ">{30}</a><br>
<br>
<span class="keyword">new</span> <span class="name">nb_1</span>: <span class="type">bitstring</span> creating <span class="name">nb_2</span> at <a href="process_1.html#occ32" target="process" class="occ">{32}</a><br>
<br>
<span class="keyword">out</span>(<span class="name">att</span>, <span class="fun"></span>(<span class="var">~M_4</span>,<span class="var">~M_5</span>)) with <span class="var">~M_4</span> = <span class="fun">HMAC_SHA256</span>(<span class="name">nb_2</span>,<span class="fun"></span>(<span class="fun">exp</span>(<span class="fun">g</span>,<span class="name">pri_b</span>),<span class="fun"></span>(<span class="fun">g</span>,<span class="fun">zero_const</span>))), <span class="var">~M_5</span> = <span class="name">c_p</span> at <a href="process_1.html#occ36" target="process" class="occ">{36}</a><br>
<br>
<span class="keyword">in</span>(<span class="name">att</span>, <span class="fun"></span>(<span class="name">a</span>,<span class="name">c_p</span>)) at <a href="process_1.html#occ37" target="process" class="occ">{37}</a><br>
<br>
<span class="keyword">out</span>(<span class="name">att</span>, <span class="fun"></span>(<span class="var">~M_6</span>,<span class="var">~M_7</span>)) with <span class="var">~M_6</span> = <span class="name">nb_2</span>, <span class="var">~M_7</span> = <span class="name">c_p</span> at <a href="process_1.html#occ38" target="process" class="occ">{38}</a><br>
<br>
<span class="keyword">in</span>(<span class="name">att</span>, <span class="fun"></span>(<span class="fun">HMAC_SHA256</span>(<span class="var">~M_2</span>,<span class="fun"></span>(<span class="name">a</span>,<span class="fun"></span>(<span class="var">~M_6</span>,<span class="fun"></span>(<span class="fun">zero_const</span>,<span class="fun"></span>(<span class="fun">iocap_A</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))),<span class="name">c_p</span>)) with <span class="fun">HMAC_SHA256</span>(<span class="var">~M_2</span>,<span class="fun"></span>(<span class="name">a</span>,<span class="fun"></span>(<span class="var">~M_6</span>,<span class="fun"></span>(<span class="fun">zero_const</span>,<span class="fun"></span>(<span class="fun">iocap_A</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))) = <span class="fun">HMAC_SHA256</span>(<span class="fun">exp</span>(<span class="fun">g</span>,<span class="name">pri_b</span>),<span class="fun"></span>(<span class="name">a</span>,<span class="fun"></span>(<span class="name">nb_2</span>,<span class="fun"></span>(<span class="fun">zero_const</span>,<span class="fun"></span>(<span class="fun">iocap_A</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))) at <a href="process_1.html#occ40" target="process" class="occ">{40}</a><br>
<br>
<span class="keyword">out</span>(<span class="name">att</span>, <span class="fun"></span>(<span class="var">~M_8</span>,<span class="var">~M_9</span>)) with <span class="var">~M_8</span> = <span class="fun">HMAC_SHA256</span>(<span class="fun">exp</span>(<span class="fun">g</span>,<span class="name">pri_b</span>),<span class="fun"></span>(<span class="name">nb_2</span>,<span class="fun"></span>(<span class="name">a</span>,<span class="fun"></span>(<span class="fun">zero_const</span>,<span class="fun"></span>(<span class="fun">iocap_B</span>,<span class="fun"></span>(<span class="fun">addr_B</span>,<span class="fun">addr_A</span>)))))), <span class="var">~M_9</span> = <span class="name">c_p</span> at <a href="process_1.html#occ41" target="process" class="occ">{41}</a><br>
<br>
<span class="keyword">new</span> <span class="name">skds_1</span>: <span class="type">bitstring</span> creating <span class="name">skds_2</span> at <a href="process_1.html#occ45" target="process" class="occ">{45}</a><br>
<br>
<span class="keyword">new</span> <span class="name">ivs_1</span>: <span class="type">bitstring</span> creating <span class="name">ivs_2</span> at <a href="process_1.html#occ46" target="process" class="occ">{46}</a><br>
<br>
<span class="keyword">in</span>(<span class="name">att</span>, <span class="fun"></span>(<span class="name">a_1</span>,<span class="fun"></span>(<span class="name">a_2</span>,<span class="name">c_p</span>))) at <a href="process_1.html#occ47" target="process" class="occ">{47}</a><br>
<br>
<span class="keyword">out</span>(<span class="name">att</span>, <span class="fun"></span>(<span class="var">~M_10</span>,<span class="fun"></span>(<span class="var">~M_11</span>,<span class="var">~M_12</span>))) with <span class="var">~M_10</span> = <span class="name">skds_2</span>, <span class="var">~M_11</span> = <span class="name">ivs_2</span>, <span class="var">~M_12</span> = <span class="name">c_p</span> at <a href="process_1.html#occ48" target="process" class="occ">{48}</a><br>
<br>
<span class="keyword">in</span>(<span class="name">att</span>, <span class="fun"></span>(<span class="fun">AES_GCM_enc</span>(<span class="fun"></span>(<span class="name">a_3</span>,<span class="name">SessionNonce</span>),<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">SALT</span>,<span class="fun">HMAC_SHA256</span>(<span class="var">~M_2</span>,<span class="fun"></span>(<span class="name">a</span>,<span class="fun"></span>(<span class="var">~M_6</span>,<span class="fun"></span>(<span class="fun">btlk</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))),<span class="fun">brle</span>),<span class="fun"></span>(<span class="var">~M_10</span>,<span class="name">a_1</span>)),<span class="fun"></span>(<span class="var">~M_11</span>,<span class="name">a_2</span>)),<span class="fun"></span>(<span class="fun">AES_GCM_enc</span>(<span class="fun"></span>(<span class="name">a_4</span>,<span class="name">E1</span>),<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">SALT</span>,<span class="fun">HMAC_SHA256</span>(<span class="var">~M_2</span>,<span class="fun"></span>(<span class="name">a</span>,<span class="fun"></span>(<span class="var">~M_6</span>,<span class="fun"></span>(<span class="fun">btlk</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))),<span class="fun">brle</span>),<span class="fun"></span>(<span class="var">~M_10</span>,<span class="name">a_1</span>)),<span class="fun"></span>(<span class="var">~M_11</span>,<span class="name">a_2</span>)),<span class="name">c_p</span>))) with <span class="fun">AES_GCM_enc</span>(<span class="fun"></span>(<span class="name">a_3</span>,<span class="name">SessionNonce</span>),<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">SALT</span>,<span class="fun">HMAC_SHA256</span>(<span class="var">~M_2</span>,<span class="fun"></span>(<span class="name">a</span>,<span class="fun"></span>(<span class="var">~M_6</span>,<span class="fun"></span>(<span class="fun">btlk</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))),<span class="fun">brle</span>),<span class="fun"></span>(<span class="var">~M_10</span>,<span class="name">a_1</span>)),<span class="fun"></span>(<span class="var">~M_11</span>,<span class="name">a_2</span>)) = <span class="fun">AES_GCM_enc</span>(<span class="fun"></span>(<span class="name">a_3</span>,<span class="name">SessionNonce</span>),<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">SALT</span>,<span class="fun">HMAC_SHA256</span>(<span class="fun">exp</span>(<span class="fun">g</span>,<span class="name">pri_b</span>),<span class="fun"></span>(<span class="name">a</span>,<span class="fun"></span>(<span class="name">nb_2</span>,<span class="fun"></span>(<span class="fun">btlk</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))),<span class="fun">brle</span>),<span class="fun"></span>(<span class="name">skds_2</span>,<span class="name">a_1</span>)),<span class="fun"></span>(<span class="name">ivs_2</span>,<span class="name">a_2</span>)), <span class="fun">AES_GCM_enc</span>(<span class="fun"></span>(<span class="name">a_4</span>,<span class="name">E1</span>),<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">SALT</span>,<span class="fun">HMAC_SHA256</span>(<span class="var">~M_2</span>,<span class="fun"></span>(<span class="name">a</span>,<span class="fun"></span>(<span class="var">~M_6</span>,<span class="fun"></span>(<span class="fun">btlk</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))),<span class="fun">brle</span>),<span class="fun"></span>(<span class="var">~M_10</span>,<span class="name">a_1</span>)),<span class="fun"></span>(<span class="var">~M_11</span>,<span class="name">a_2</span>)) = <span class="fun">AES_GCM_enc</span>(<span class="fun"></span>(<span class="name">a_4</span>,<span class="name">E1</span>),<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">SALT</span>,<span class="fun">HMAC_SHA256</span>(<span class="fun">exp</span>(<span class="fun">g</span>,<span class="name">pri_b</span>),<span class="fun"></span>(<span class="name">a</span>,<span class="fun"></span>(<span class="name">nb_2</span>,<span class="fun"></span>(<span class="fun">btlk</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))),<span class="fun">brle</span>),<span class="fun"></span>(<span class="name">skds_2</span>,<span class="name">a_1</span>)),<span class="fun"></span>(<span class="name">ivs_2</span>,<span class="name">a_2</span>)) at <a href="process_1.html#occ51" target="process" class="occ">{51}</a><br>
<br>
<span class="keyword">event</span> <span class="fun">Stepp1</span> at <a href="process_1.html#occ54" target="process" class="occ">{54}</a><br>
<br>
<span class="keyword">new</span> <span class="name">s_2</span>: <span class="type">bitstring</span> creating <span class="name">s_4</span> at <a href="process_1.html#occ55" target="process" class="occ">{55}</a><br>
<br>
<span class="keyword">new</span> <span class="name">r_1</span>: <span class="type">bitstring</span> creating <span class="name">r_2</span> at <a href="process_1.html#occ56" target="process" class="occ">{56}</a><br>
<br>
<span class="keyword">new</span> <span class="name">SeedK1</span>: <span class="type">bitstring</span> creating <span class="name">SeedK1_2</span> at <a href="process_1.html#occ59" target="process" class="occ">{59}</a><br>
<br>
<span class="keyword">new</span> <span class="name">exp_2_1</span>: <span class="type">bitstring</span> creating <span class="name">exp_1</span> at <a href="process_1.html#occ60" target="process" class="occ">{60}</a><br>
<br>
<span class="keyword">new</span> <span class="name">token</span>: <span class="type">bitstring</span> creating <span class="name">token_2</span> at <a href="process_1.html#occ61" target="process" class="occ">{61}</a><br>
<br>
<span class="keyword">new</span> <span class="name">SN</span>: <span class="type">bitstring</span> creating <span class="name">SN_2</span> at <a href="process_1.html#occ62" target="process" class="occ">{62}</a><br>
<br>
<span class="keyword">new</span> <span class="name">data</span>: <span class="type">bitstring</span> creating <span class="name">data_2</span> at <a href="process_1.html#occ63" target="process" class="occ">{63}</a><br>
<br>
<span class="keyword">new</span> <span class="name">Version</span>: <span class="type">bitstring</span> creating <span class="name">Version_2</span> at <a href="process_1.html#occ64" target="process" class="occ">{64}</a><br>
<br>
<span class="keyword">event</span> <span class="fun">SendSessionNonce</span>(<span class="name">a_3</span>) at <a href="process_1.html#occ70" target="process" class="occ">{70}</a><br>
<br>
<span class="keyword">event</span> <span class="fun">SendE1</span>(<span class="name">a_4</span>) at <a href="process_1.html#occ71" target="process" class="occ">{71}</a><br>
<br>
<span class="keyword">out</span>(<span class="name">att</span>, <span class="fun"></span>(<span class="var">~M_13</span>,<span class="fun"></span>(<span class="var">~M_14</span>,<span class="var">~M_15</span>))) with <span class="var">~M_13</span> = <span class="fun">AES_GCM_enc</span>(<span class="fun"></span>(<span class="fun">SHA256</span>(<span class="fun"></span>(<span class="name">s_4</span>,<span class="name">r_2</span>)),<span class="name">C1</span>),<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">SALT</span>,<span class="fun">HMAC_SHA256</span>(<span class="fun">exp</span>(<span class="fun">g</span>,<span class="name">pri_b</span>),<span class="fun"></span>(<span class="name">a</span>,<span class="fun"></span>(<span class="name">nb_2</span>,<span class="fun"></span>(<span class="fun">btlk</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))),<span class="fun">brle</span>),<span class="fun"></span>(<span class="name">skds_2</span>,<span class="name">a_1</span>)),<span class="fun"></span>(<span class="name">ivs_2</span>,<span class="name">a_2</span>)), <span class="var">~M_14</span> = <span class="fun">AES_GCM_enc</span>(<span class="fun"></span>(<span class="fun"></span>(<span class="fun">exp</span>(<span class="fun">g</span>,<span class="name">exp_1</span>),<span class="fun">AES_GCM_enc</span>(<span class="fun"></span>(<span class="name">a_3</span>,<span class="fun"></span>(<span class="name">token_2</span>,<span class="fun"></span>(<span class="name">UUID_2</span>,<span class="fun"></span>(<span class="name">SN_2</span>,<span class="fun"></span>(<span class="name">data_2</span>,<span class="fun"></span>(<span class="name">Version_2</span>,<span class="fun"></span>(<span class="name">a_4</span>,<span class="name">SeedK1_2</span>))))))),<span class="fun">kdf</span>(<span class="fun">exp</span>(<span class="fun">exp</span>(<span class="fun">g</span>,<span class="fun">qe</span>),<span class="name">exp_1</span>),<span class="fun">exp</span>(<span class="fun">g</span>,<span class="name">exp_1</span>)),<span class="fun">kdf</span>(<span class="fun">exp</span>(<span class="fun">exp</span>(<span class="fun">g</span>,<span class="fun">qe</span>),<span class="name">exp_1</span>),<span class="fun">exp</span>(<span class="fun">g</span>,<span class="name">exp_1</span>)))),<span class="name">E2</span>),<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">SALT</span>,<span class="fun">HMAC_SHA256</span>(<span class="fun">exp</span>(<span class="fun">g</span>,<span class="name">pri_b</span>),<span class="fun"></span>(<span class="name">a</span>,<span class="fun"></span>(<span class="name">nb_2</span>,<span class="fun"></span>(<span class="fun">btlk</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))),<span class="fun">brle</span>),<span class="fun"></span>(<span class="name">skds_2</span>,<span class="name">a_1</span>)),<span class="fun"></span>(<span class="name">ivs_2</span>,<span class="name">a_2</span>)), <span class="var">~M_15</span> = <span class="name">c_p</span> at <a href="process_1.html#occ73" target="process" class="occ">{73}</a><br>
<br>
<span class="keyword">in</span>(<span class="name">att</span>, <span class="fun"></span>(<span class="fun">g</span>,<span class="name">c_p</span>)) at <a href="process_1.html#occ103" target="process" class="occ">{103}</a><br>
<br>
<span class="keyword">new</span> <span class="name">na</span>: <span class="type">bitstring</span> creating <span class="name">na_2</span> at <a href="process_1.html#occ105" target="process" class="occ">{105}</a><br>
<br>
<span class="keyword">in</span>(<span class="name">att</span>, <span class="fun"></span>(<span class="fun">HMAC_SHA256</span>(<span class="name">a_5</span>,<span class="fun"></span>(<span class="fun">g</span>,<span class="fun"></span>(<span class="var">~M</span>,<span class="fun">zero_const</span>))),<span class="name">c_p</span>)) with <span class="fun">HMAC_SHA256</span>(<span class="name">a_5</span>,<span class="fun"></span>(<span class="fun">g</span>,<span class="fun"></span>(<span class="var">~M</span>,<span class="fun">zero_const</span>))) = <span class="fun">HMAC_SHA256</span>(<span class="name">a_5</span>,<span class="fun"></span>(<span class="fun">g</span>,<span class="fun"></span>(<span class="fun">exp</span>(<span class="fun">g</span>,<span class="name">pri_a</span>),<span class="fun">zero_const</span>))) at <a href="process_1.html#occ108" target="process" class="occ">{108}</a><br>
<br>
<span class="keyword">out</span>(<span class="name">att</span>, <span class="fun"></span>(<span class="var">~M_16</span>,<span class="var">~M_17</span>)) with <span class="var">~M_16</span> = <span class="name">na_2</span>, <span class="var">~M_17</span> = <span class="name">c_p</span> at <a href="process_1.html#occ109" target="process" class="occ">{109}</a><br>
<br>
<span class="keyword">in</span>(<span class="name">att</span>, <span class="fun"></span>(<span class="name">a_5</span>,<span class="name">c_p</span>)) at <a href="process_1.html#occ110" target="process" class="occ">{110}</a><br>
<br>
<span class="keyword">event</span> <span class="fun">Stepc0</span> at <a href="process_1.html#occ112" target="process" class="occ">{112}</a><br>
<br>
<span class="keyword">out</span>(<span class="name">att</span>, <span class="fun"></span>(<span class="var">~M_18</span>,<span class="var">~M_19</span>)) with <span class="var">~M_18</span> = <span class="fun">HMAC_SHA256</span>(<span class="fun">exp</span>(<span class="fun">g</span>,<span class="name">pri_a</span>),<span class="fun"></span>(<span class="name">na_2</span>,<span class="fun"></span>(<span class="name">a_5</span>,<span class="fun"></span>(<span class="fun">zero_const</span>,<span class="fun"></span>(<span class="fun">iocap_A</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))), <span class="var">~M_19</span> = <span class="name">c_p</span> at <a href="process_1.html#occ114" target="process" class="occ">{114}</a><br>
<br>
<span class="keyword">in</span>(<span class="name">att</span>, <span class="fun"></span>(<span class="fun">HMAC_SHA256</span>(<span class="var">~M</span>,<span class="fun"></span>(<span class="name">a_5</span>,<span class="fun"></span>(<span class="var">~M_16</span>,<span class="fun"></span>(<span class="fun">zero_const</span>,<span class="fun"></span>(<span class="fun">iocap_B</span>,<span class="fun"></span>(<span class="fun">addr_B</span>,<span class="fun">addr_A</span>)))))),<span class="name">c_p</span>)) with <span class="fun">HMAC_SHA256</span>(<span class="var">~M</span>,<span class="fun"></span>(<span class="name">a_5</span>,<span class="fun"></span>(<span class="var">~M_16</span>,<span class="fun"></span>(<span class="fun">zero_const</span>,<span class="fun"></span>(<span class="fun">iocap_B</span>,<span class="fun"></span>(<span class="fun">addr_B</span>,<span class="fun">addr_A</span>)))))) = <span class="fun">HMAC_SHA256</span>(<span class="fun">exp</span>(<span class="fun">g</span>,<span class="name">pri_a</span>),<span class="fun"></span>(<span class="name">a_5</span>,<span class="fun"></span>(<span class="name">na_2</span>,<span class="fun"></span>(<span class="fun">zero_const</span>,<span class="fun"></span>(<span class="fun">iocap_B</span>,<span class="fun"></span>(<span class="fun">addr_B</span>,<span class="fun">addr_A</span>)))))) at <a href="process_1.html#occ115" target="process" class="occ">{115}</a><br>
<br>
<span class="keyword">event</span> <span class="fun">Stepc1</span> at <a href="process_1.html#occ117" target="process" class="occ">{117}</a><br>
<br>
<span class="keyword">new</span> <span class="name">skdm</span>: <span class="type">bitstring</span> creating <span class="name">skdm_2</span> at <a href="process_1.html#occ120" target="process" class="occ">{120}</a><br>
<br>
<span class="keyword">new</span> <span class="name">ivm</span>: <span class="type">bitstring</span> creating <span class="name">ivm_2</span> at <a href="process_1.html#occ121" target="process" class="occ">{121}</a><br>
<br>
<span class="keyword">out</span>(<span class="name">att</span>, <span class="fun"></span>(<span class="var">~M_20</span>,<span class="fun"></span>(<span class="var">~M_21</span>,<span class="var">~M_22</span>))) with <span class="var">~M_20</span> = <span class="name">skdm_2</span>, <span class="var">~M_21</span> = <span class="name">ivm_2</span>, <span class="var">~M_22</span> = <span class="name">c_p</span> at <a href="process_1.html#occ122" target="process" class="occ">{122}</a><br>
<br>
<span class="keyword">in</span>(<span class="name">att</span>, <span class="fun"></span>(<span class="name">a_6</span>,<span class="fun"></span>(<span class="name">a_7</span>,<span class="name">c_p</span>))) at <a href="process_1.html#occ123" target="process" class="occ">{123}</a><br>
<br>
<span class="keyword">new</span> <span class="name">SessionNonce_3</span>: <span class="type">bitstring</span> creating <span class="name">SessionNonce_4</span> at <a href="process_1.html#occ126" target="process" class="occ">{126}</a><br>
<br>
<span class="keyword">event</span> <span class="fun">SessionNonceSource</span>(<span class="name">SessionNonce_4</span>) at <a href="process_1.html#occ127" target="process" class="occ">{127}</a><br>
<br>
<span class="keyword">new</span> <span class="name">E1_3</span>: <span class="type">bitstring</span> creating <span class="name">E1_4</span> at <a href="process_1.html#occ128" target="process" class="occ">{128}</a><br>
<br>
<span class="keyword">event</span> <span class="fun">E1Source</span>(<span class="name">E1_4</span>) at <a href="process_1.html#occ129" target="process" class="occ">{129}</a><br>
<br>
<span class="keyword">out</span>(<span class="name">att</span>, <span class="fun"></span>(<span class="var">~M_23</span>,<span class="fun"></span>(<span class="var">~M_24</span>,<span class="var">~M_25</span>))) with <span class="var">~M_23</span> = <span class="fun">AES_GCM_enc</span>(<span class="fun"></span>(<span class="name">SessionNonce_4</span>,<span class="name">SessionNonce</span>),<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">SALT</span>,<span class="fun">HMAC_SHA256</span>(<span class="fun">exp</span>(<span class="fun">g</span>,<span class="name">pri_a</span>),<span class="fun"></span>(<span class="name">na_2</span>,<span class="fun"></span>(<span class="name">a_5</span>,<span class="fun"></span>(<span class="fun">btlk</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))),<span class="fun">brle</span>),<span class="fun"></span>(<span class="name">a_6</span>,<span class="name">skdm_2</span>)),<span class="fun"></span>(<span class="name">a_7</span>,<span class="name">ivm_2</span>)), <span class="var">~M_24</span> = <span class="fun">AES_GCM_enc</span>(<span class="fun"></span>(<span class="name">E1_4</span>,<span class="name">E1</span>),<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">SALT</span>,<span class="fun">HMAC_SHA256</span>(<span class="fun">exp</span>(<span class="fun">g</span>,<span class="name">pri_a</span>),<span class="fun"></span>(<span class="name">na_2</span>,<span class="fun"></span>(<span class="name">a_5</span>,<span class="fun"></span>(<span class="fun">btlk</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))),<span class="fun">brle</span>),<span class="fun"></span>(<span class="name">a_6</span>,<span class="name">skdm_2</span>)),<span class="fun"></span>(<span class="name">a_7</span>,<span class="name">ivm_2</span>)), <span class="var">~M_25</span> = <span class="name">c_p</span> at <a href="process_1.html#occ130" target="process" class="occ">{130}</a><br>
<br>
<span class="keyword">in</span>(<span class="name">att</span>, <span class="fun"></span>(<span class="fun">AES_GCM_enc</span>(<span class="fun"></span>(<span class="fun">1-proj-2-tuple</span>(<span class="fun">AES_GCM_dec</span>(<span class="var">~M_13</span>,<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">SALT</span>,<span class="fun">HMAC_SHA256</span>(<span class="var">~M_2</span>,<span class="fun"></span>(<span class="name">a</span>,<span class="fun"></span>(<span class="var">~M_6</span>,<span class="fun"></span>(<span class="fun">btlk</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))),<span class="fun">brle</span>),<span class="fun"></span>(<span class="var">~M_10</span>,<span class="name">a_1</span>)),<span class="fun"></span>(<span class="var">~M_11</span>,<span class="name">a_2</span>))),<span class="name">C1</span>),<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">SALT</span>,<span class="fun">HMAC_SHA256</span>(<span class="var">~M</span>,<span class="fun"></span>(<span class="var">~M_16</span>,<span class="fun"></span>(<span class="name">a_5</span>,<span class="fun"></span>(<span class="fun">btlk</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))),<span class="fun">brle</span>),<span class="fun"></span>(<span class="name">a_6</span>,<span class="var">~M_20</span>)),<span class="fun"></span>(<span class="name">a_7</span>,<span class="var">~M_21</span>)),<span class="fun"></span>(<span class="fun">AES_GCM_enc</span>(<span class="fun"></span>(<span class="fun"></span>(<span class="fun">1-proj-2-tuple</span>(<span class="fun">1-proj-2-tuple</span>(<span class="fun">AES_GCM_dec</span>(<span class="var">~M_14</span>,<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">SALT</span>,<span class="fun">HMAC_SHA256</span>(<span class="var">~M_2</span>,<span class="fun"></span>(<span class="name">a</span>,<span class="fun"></span>(<span class="var">~M_6</span>,<span class="fun"></span>(<span class="fun">btlk</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))),<span class="fun">brle</span>),<span class="fun"></span>(<span class="var">~M_10</span>,<span class="name">a_1</span>)),<span class="fun"></span>(<span class="var">~M_11</span>,<span class="name">a_2</span>)))),<span class="fun">2-proj-2-tuple</span>(<span class="fun">1-proj-2-tuple</span>(<span class="fun">AES_GCM_dec</span>(<span class="var">~M_14</span>,<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">SALT</span>,<span class="fun">HMAC_SHA256</span>(<span class="var">~M_2</span>,<span class="fun"></span>(<span class="name">a</span>,<span class="fun"></span>(<span class="var">~M_6</span>,<span class="fun"></span>(<span class="fun">btlk</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))),<span class="fun">brle</span>),<span class="fun"></span>(<span class="var">~M_10</span>,<span class="name">a_1</span>)),<span class="fun"></span>(<span class="var">~M_11</span>,<span class="name">a_2</span>))))),<span class="name">E2</span>),<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">SALT</span>,<span class="fun">HMAC_SHA256</span>(<span class="var">~M</span>,<span class="fun"></span>(<span class="var">~M_16</span>,<span class="fun"></span>(<span class="name">a_5</span>,<span class="fun"></span>(<span class="fun">btlk</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))),<span class="fun">brle</span>),<span class="fun"></span>(<span class="name">a_6</span>,<span class="var">~M_20</span>)),<span class="fun"></span>(<span class="name">a_7</span>,<span class="var">~M_21</span>)),<span class="name">c_p</span>))) with <span class="fun">AES_GCM_enc</span>(<span class="fun"></span>(<span class="fun">1-proj-2-tuple</span>(<span class="fun">AES_GCM_dec</span>(<span class="var">~M_13</span>,<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">SALT</span>,<span class="fun">HMAC_SHA256</span>(<span class="var">~M_2</span>,<span class="fun"></span>(<span class="name">a</span>,<span class="fun"></span>(<span class="var">~M_6</span>,<span class="fun"></span>(<span class="fun">btlk</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))),<span class="fun">brle</span>),<span class="fun"></span>(<span class="var">~M_10</span>,<span class="name">a_1</span>)),<span class="fun"></span>(<span class="var">~M_11</span>,<span class="name">a_2</span>))),<span class="name">C1</span>),<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">SALT</span>,<span class="fun">HMAC_SHA256</span>(<span class="var">~M</span>,<span class="fun"></span>(<span class="var">~M_16</span>,<span class="fun"></span>(<span class="name">a_5</span>,<span class="fun"></span>(<span class="fun">btlk</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))),<span class="fun">brle</span>),<span class="fun"></span>(<span class="name">a_6</span>,<span class="var">~M_20</span>)),<span class="fun"></span>(<span class="name">a_7</span>,<span class="var">~M_21</span>)) = <span class="fun">AES_GCM_enc</span>(<span class="fun"></span>(<span class="fun">SHA256</span>(<span class="fun"></span>(<span class="name">s_4</span>,<span class="name">r_2</span>)),<span class="name">C1</span>),<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">SALT</span>,<span class="fun">HMAC_SHA256</span>(<span class="fun">exp</span>(<span class="fun">g</span>,<span class="name">pri_a</span>),<span class="fun"></span>(<span class="name">na_2</span>,<span class="fun"></span>(<span class="name">a_5</span>,<span class="fun"></span>(<span class="fun">btlk</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))),<span class="fun">brle</span>),<span class="fun"></span>(<span class="name">a_6</span>,<span class="name">skdm_2</span>)),<span class="fun"></span>(<span class="name">a_7</span>,<span class="name">ivm_2</span>)), <span class="fun">AES_GCM_enc</span>(<span class="fun"></span>(<span class="fun"></span>(<span class="fun">1-proj-2-tuple</span>(<span class="fun">1-proj-2-tuple</span>(<span class="fun">AES_GCM_dec</span>(<span class="var">~M_14</span>,<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">SALT</span>,<span class="fun">HMAC_SHA256</span>(<span class="var">~M_2</span>,<span class="fun"></span>(<span class="name">a</span>,<span class="fun"></span>(<span class="var">~M_6</span>,<span class="fun"></span>(<span class="fun">btlk</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))),<span class="fun">brle</span>),<span class="fun"></span>(<span class="var">~M_10</span>,<span class="name">a_1</span>)),<span class="fun"></span>(<span class="var">~M_11</span>,<span class="name">a_2</span>)))),<span class="fun">2-proj-2-tuple</span>(<span class="fun">1-proj-2-tuple</span>(<span class="fun">AES_GCM_dec</span>(<span class="var">~M_14</span>,<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">SALT</span>,<span class="fun">HMAC_SHA256</span>(<span class="var">~M_2</span>,<span class="fun"></span>(<span class="name">a</span>,<span class="fun"></span>(<span class="var">~M_6</span>,<span class="fun"></span>(<span class="fun">btlk</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))),<span class="fun">brle</span>),<span class="fun"></span>(<span class="var">~M_10</span>,<span class="name">a_1</span>)),<span class="fun"></span>(<span class="var">~M_11</span>,<span class="name">a_2</span>))))),<span class="name">E2</span>),<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">SALT</span>,<span class="fun">HMAC_SHA256</span>(<span class="var">~M</span>,<span class="fun"></span>(<span class="var">~M_16</span>,<span class="fun"></span>(<span class="name">a_5</span>,<span class="fun"></span>(<span class="fun">btlk</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))),<span class="fun">brle</span>),<span class="fun"></span>(<span class="name">a_6</span>,<span class="var">~M_20</span>)),<span class="fun"></span>(<span class="name">a_7</span>,<span class="var">~M_21</span>)) = <span class="fun">AES_GCM_enc</span>(<span class="fun"></span>(<span class="fun"></span>(<span class="fun">exp</span>(<span class="fun">g</span>,<span class="name">exp_1</span>),<span class="fun">AES_GCM_enc</span>(<span class="fun"></span>(<span class="name">a_3</span>,<span class="fun"></span>(<span class="name">token_2</span>,<span class="fun"></span>(<span class="name">UUID_2</span>,<span class="fun"></span>(<span class="name">SN_2</span>,<span class="fun"></span>(<span class="name">data_2</span>,<span class="fun"></span>(<span class="name">Version_2</span>,<span class="fun"></span>(<span class="name">a_4</span>,<span class="name">SeedK1_2</span>))))))),<span class="fun">kdf</span>(<span class="fun">exp</span>(<span class="fun">exp</span>(<span class="fun">g</span>,<span class="fun">qe</span>),<span class="name">exp_1</span>),<span class="fun">exp</span>(<span class="fun">g</span>,<span class="name">exp_1</span>)),<span class="fun">kdf</span>(<span class="fun">exp</span>(<span class="fun">exp</span>(<span class="fun">g</span>,<span class="fun">qe</span>),<span class="name">exp_1</span>),<span class="fun">exp</span>(<span class="fun">g</span>,<span class="name">exp_1</span>)))),<span class="name">E2</span>),<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">SALT</span>,<span class="fun">HMAC_SHA256</span>(<span class="fun">exp</span>(<span class="fun">g</span>,<span class="name">pri_a</span>),<span class="fun"></span>(<span class="name">na_2</span>,<span class="fun"></span>(<span class="name">a_5</span>,<span class="fun"></span>(<span class="fun">btlk</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))),<span class="fun">brle</span>),<span class="fun"></span>(<span class="name">a_6</span>,<span class="name">skdm_2</span>)),<span class="fun"></span>(<span class="name">a_7</span>,<span class="name">ivm_2</span>)) at <a href="process_1.html#occ131" target="process" class="occ">{131}</a><br>
<br>
<span class="keyword">new</span> <span class="name">s__1</span>: <span class="type">bitstring</span> creating <span class="name">s_</span> at <a href="process_1.html#occ134" target="process" class="occ">{134}</a><br>
<br>
<span class="keyword">new</span> <span class="name">r_</span>: <span class="type">bitstring</span> creating <span class="name">r__2</span> at <a href="process_1.html#occ135" target="process" class="occ">{135}</a><br>
<br>
<span class="keyword">out</span>(<span class="name">sec_ch</span>, <span class="fun"></span>(<span class="fun">SHA256</span>(<span class="fun"></span>(<span class="fun">exp</span>(<span class="fun">g</span>,<span class="name">s_</span>),<span class="name">r__2</span>)),<span class="fun"></span>(<span class="fun"></span>(<span class="fun">exp</span>(<span class="fun">g</span>,<span class="name">exp_1</span>),<span class="fun">AES_GCM_enc</span>(<span class="fun"></span>(<span class="name">a_3</span>,<span class="fun"></span>(<span class="name">token_2</span>,<span class="fun"></span>(<span class="name">UUID_2</span>,<span class="fun"></span>(<span class="name">SN_2</span>,<span class="fun"></span>(<span class="name">data_2</span>,<span class="fun"></span>(<span class="name">Version_2</span>,<span class="fun"></span>(<span class="name">a_4</span>,<span class="name">SeedK1_2</span>))))))),<span class="fun">kdf</span>(<span class="fun">exp</span>(<span class="fun">exp</span>(<span class="fun">g</span>,<span class="fun">qe</span>),<span class="name">exp_1</span>),<span class="fun">exp</span>(<span class="fun">g</span>,<span class="name">exp_1</span>)),<span class="fun">kdf</span>(<span class="fun">exp</span>(<span class="fun">exp</span>(<span class="fun">g</span>,<span class="fun">qe</span>),<span class="name">exp_1</span>),<span class="fun">exp</span>(<span class="fun">g</span>,<span class="name">exp_1</span>)))),<span class="name">s_c</span>))) at <a href="process_1.html#occ138" target="process" class="occ">{138}</a> received at <a href="process_1.html#occ4" target="process" class="occ">{4}</a><br>
<br>
<span class="keyword">new</span> <span class="name">token_new_1</span>: <span class="type">bitstring</span> creating <span class="name">token_new</span> at <a href="process_1.html#occ11" target="process" class="occ">{11}</a><br>
<br>
<span class="keyword">event</span> <span class="fun">TokenNewSource</span>(<span class="name">token_new</span>) at <a href="process_1.html#occ12" target="process" class="occ">{12}</a><br>
<br>
<span class="keyword">new</span> <span class="name">SeedS_1</span>: <span class="type">bitstring</span> creating <span class="name">SeedS_3</span> at <a href="process_1.html#occ13" target="process" class="occ">{13}</a><br>
<br>
<span class="keyword">event</span> <span class="fun">E3Source</span>(<span class="fun">AES_GCM_enc</span>(<span class="name">token_new</span>,<span class="fun">kdf</span>(<span class="fun">kdf</span>(<span class="fun"></span>(<span class="name">SeedS_3</span>,<span class="name">SeedK1_2</span>),<span class="fun">ServerSharedSecret_const</span>),<span class="fun">PairingSession_const</span>),<span class="fun">kdf</span>(<span class="fun">kdf</span>(<span class="fun"></span>(<span class="name">SeedS_3</span>,<span class="name">SeedK1_2</span>),<span class="fun">ServerSharedSecret_const</span>),<span class="fun">PairingSession_const</span>))) at <a href="process_1.html#occ19" target="process" class="occ">{19}</a><br>
<br>
<span class="keyword">event</span> <span class="fun">C2ParamSource</span>(<span class="fun">AES_GCM_enc</span>(<span class="name">token_new</span>,<span class="fun">kdf</span>(<span class="fun">kdf</span>(<span class="fun"></span>(<span class="name">SeedS_3</span>,<span class="name">SeedK1_2</span>),<span class="fun">ServerSharedSecret_const</span>),<span class="fun">PairingSession_const</span>),<span class="fun">kdf</span>(<span class="fun">kdf</span>(<span class="fun"></span>(<span class="name">SeedS_3</span>,<span class="name">SeedK1_2</span>),<span class="fun">ServerSharedSecret_const</span>),<span class="fun">PairingSession_const</span>)),<span class="name">SeedS_3</span>,<span class="fun">sign</span>(<span class="fun"></span>(<span class="name">UUID_2</span>,<span class="fun"></span>(<span class="name">a_3</span>,<span class="fun"></span>(<span class="name">SeedS_3</span>,<span class="fun"></span>(<span class="fun">SHA256</span>(<span class="fun"></span>(<span class="fun">exp</span>(<span class="fun">g</span>,<span class="name">s_</span>),<span class="name">r__2</span>)),<span class="fun"></span>(<span class="name">a_4</span>,<span class="fun">AES_GCM_enc</span>(<span class="name">token_new</span>,<span class="fun">kdf</span>(<span class="fun">kdf</span>(<span class="fun"></span>(<span class="name">SeedS_3</span>,<span class="name">SeedK1_2</span>),<span class="fun">ServerSharedSecret_const</span>),<span class="fun">PairingSession_const</span>),<span class="fun">kdf</span>(<span class="fun">kdf</span>(<span class="fun"></span>(<span class="name">SeedS_3</span>,<span class="name">SeedK1_2</span>),<span class="fun">ServerSharedSecret_const</span>),<span class="fun">PairingSession_const</span>))))))),<span class="fun">qa</span>),<span class="name">iCloudldentifier_3</span>) at <a href="process_1.html#occ22" target="process" class="occ">{22}</a><br>
<br>
<span class="keyword">out</span>(<span class="name">sec_ch</span>, <span class="fun"></span>(<span class="name">iCloudldentifier_3</span>,<span class="fun"></span>(<span class="name">SeedS_3</span>,<span class="fun"></span>(<span class="fun">sign</span>(<span class="fun"></span>(<span class="name">UUID_2</span>,<span class="fun"></span>(<span class="name">a_3</span>,<span class="fun"></span>(<span class="name">SeedS_3</span>,<span class="fun"></span>(<span class="fun">SHA256</span>(<span class="fun"></span>(<span class="fun">exp</span>(<span class="fun">g</span>,<span class="name">s_</span>),<span class="name">r__2</span>)),<span class="fun"></span>(<span class="name">a_4</span>,<span class="fun">AES_GCM_enc</span>(<span class="name">token_new</span>,<span class="fun">kdf</span>(<span class="fun">kdf</span>(<span class="fun"></span>(<span class="name">SeedS_3</span>,<span class="name">SeedK1_2</span>),<span class="fun">ServerSharedSecret_const</span>),<span class="fun">PairingSession_const</span>),<span class="fun">kdf</span>(<span class="fun">kdf</span>(<span class="fun"></span>(<span class="name">SeedS_3</span>,<span class="name">SeedK1_2</span>),<span class="fun">ServerSharedSecret_const</span>),<span class="fun">PairingSession_const</span>))))))),<span class="fun">qa</span>),<span class="fun"></span>(<span class="fun">AES_GCM_enc</span>(<span class="name">token_new</span>,<span class="fun">kdf</span>(<span class="fun">kdf</span>(<span class="fun"></span>(<span class="name">SeedS_3</span>,<span class="name">SeedK1_2</span>),<span class="fun">ServerSharedSecret_const</span>),<span class="fun">PairingSession_const</span>),<span class="fun">kdf</span>(<span class="fun">kdf</span>(<span class="fun"></span>(<span class="name">SeedS_3</span>,<span class="name">SeedK1_2</span>),<span class="fun">ServerSharedSecret_const</span>),<span class="fun">PairingSession_const</span>)),<span class="name">s_c</span>))))) at <a href="process_1.html#occ23" target="process" class="occ">{23}</a> received at <a href="process_1.html#occ139" target="process" class="occ">{139}</a><br>
<br>
<span class="keyword">event</span> <span class="fun">RecvE3</span>(<span class="fun">AES_GCM_enc</span>(<span class="name">token_new</span>,<span class="fun">kdf</span>(<span class="fun">kdf</span>(<span class="fun"></span>(<span class="name">SeedS_3</span>,<span class="name">SeedK1_2</span>),<span class="fun">ServerSharedSecret_const</span>),<span class="fun">PairingSession_const</span>),<span class="fun">kdf</span>(<span class="fun">kdf</span>(<span class="fun"></span>(<span class="name">SeedS_3</span>,<span class="name">SeedK1_2</span>),<span class="fun">ServerSharedSecret_const</span>),<span class="fun">PairingSession_const</span>))) at <a href="process_1.html#occ140" target="process" class="occ">{140}</a><br>
<br>
<span class="keyword">event</span> <span class="fun">SendC2Param</span>(<span class="fun">AES_GCM_enc</span>(<span class="name">token_new</span>,<span class="fun">kdf</span>(<span class="fun">kdf</span>(<span class="fun"></span>(<span class="name">SeedS_3</span>,<span class="name">SeedK1_2</span>),<span class="fun">ServerSharedSecret_const</span>),<span class="fun">PairingSession_const</span>),<span class="fun">kdf</span>(<span class="fun">kdf</span>(<span class="fun"></span>(<span class="name">SeedS_3</span>,<span class="name">SeedK1_2</span>),<span class="fun">ServerSharedSecret_const</span>),<span class="fun">PairingSession_const</span>)),<span class="name">SeedS_3</span>,<span class="fun">sign</span>(<span class="fun"></span>(<span class="name">UUID_2</span>,<span class="fun"></span>(<span class="name">a_3</span>,<span class="fun"></span>(<span class="name">SeedS_3</span>,<span class="fun"></span>(<span class="fun">SHA256</span>(<span class="fun"></span>(<span class="fun">exp</span>(<span class="fun">g</span>,<span class="name">s_</span>),<span class="name">r__2</span>)),<span class="fun"></span>(<span class="name">a_4</span>,<span class="fun">AES_GCM_enc</span>(<span class="name">token_new</span>,<span class="fun">kdf</span>(<span class="fun">kdf</span>(<span class="fun"></span>(<span class="name">SeedS_3</span>,<span class="name">SeedK1_2</span>),<span class="fun">ServerSharedSecret_const</span>),<span class="fun">PairingSession_const</span>),<span class="fun">kdf</span>(<span class="fun">kdf</span>(<span class="fun"></span>(<span class="name">SeedS_3</span>,<span class="name">SeedK1_2</span>),<span class="fun">ServerSharedSecret_const</span>),<span class="fun">PairingSession_const</span>))))))),<span class="fun">qa</span>),<span class="name">iCloudldentifier_3</span>) at <a href="process_1.html#occ142" target="process" class="occ">{142}</a><br>
<br>
<span class="keyword">out</span>(<span class="name">att</span>, <span class="fun"></span>(<span class="var">~M_26</span>,<span class="var">~M_27</span>)) with <span class="var">~M_26</span> = <span class="fun">AES_GCM_enc</span>(<span class="fun"></span>(<span class="fun">exp</span>(<span class="fun">g</span>,<span class="name">s_</span>),<span class="fun"></span>(<span class="name">r__2</span>,<span class="fun"></span>(<span class="fun">AES_GCM_enc</span>(<span class="name">token_new</span>,<span class="fun">kdf</span>(<span class="fun">kdf</span>(<span class="fun"></span>(<span class="name">SeedS_3</span>,<span class="name">SeedK1_2</span>),<span class="fun">ServerSharedSecret_const</span>),<span class="fun">PairingSession_const</span>),<span class="fun">kdf</span>(<span class="fun">kdf</span>(<span class="fun"></span>(<span class="name">SeedS_3</span>,<span class="name">SeedK1_2</span>),<span class="fun">ServerSharedSecret_const</span>),<span class="fun">PairingSession_const</span>)),<span class="fun"></span>(<span class="name">SeedS_3</span>,<span class="fun"></span>(<span class="fun">sign</span>(<span class="fun"></span>(<span class="name">UUID_2</span>,<span class="fun"></span>(<span class="name">a_3</span>,<span class="fun"></span>(<span class="name">SeedS_3</span>,<span class="fun"></span>(<span class="fun">SHA256</span>(<span class="fun"></span>(<span class="fun">exp</span>(<span class="fun">g</span>,<span class="name">s_</span>),<span class="name">r__2</span>)),<span class="fun"></span>(<span class="name">a_4</span>,<span class="fun">AES_GCM_enc</span>(<span class="name">token_new</span>,<span class="fun">kdf</span>(<span class="fun">kdf</span>(<span class="fun"></span>(<span class="name">SeedS_3</span>,<span class="name">SeedK1_2</span>),<span class="fun">ServerSharedSecret_const</span>),<span class="fun">PairingSession_const</span>),<span class="fun">kdf</span>(<span class="fun">kdf</span>(<span class="fun"></span>(<span class="name">SeedS_3</span>,<span class="name">SeedK1_2</span>),<span class="fun">ServerSharedSecret_const</span>),<span class="fun">PairingSession_const</span>))))))),<span class="fun">qa</span>),<span class="name">iCloudldentifier_3</span>))))),<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">SALT</span>,<span class="fun">HMAC_SHA256</span>(<span class="fun">exp</span>(<span class="fun">g</span>,<span class="name">pri_a</span>),<span class="fun"></span>(<span class="name">na_2</span>,<span class="fun"></span>(<span class="name">a_5</span>,<span class="fun"></span>(<span class="fun">btlk</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))),<span class="fun">brle</span>),<span class="fun"></span>(<span class="name">a_6</span>,<span class="name">skdm_2</span>)),<span class="fun"></span>(<span class="name">a_7</span>,<span class="name">ivm_2</span>)), <span class="var">~M_27</span> = <span class="name">c_p</span> at <a href="process_1.html#occ143" target="process" class="occ">{143}</a><br>
<br>
<span class="keyword">in</span>(<span class="name">att</span>, <span class="fun"></span>(<span class="fun">AES_GCM_enc</span>(<span class="fun"></span>(<span class="fun">1-proj-2-tuple</span>(<span class="fun">AES_GCM_dec</span>(<span class="var">~M_26</span>,<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">SALT</span>,<span class="fun">HMAC_SHA256</span>(<span class="var">~M</span>,<span class="fun"></span>(<span class="var">~M_16</span>,<span class="fun"></span>(<span class="name">a_5</span>,<span class="fun"></span>(<span class="fun">btlk</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))),<span class="fun">brle</span>),<span class="fun"></span>(<span class="name">a_6</span>,<span class="var">~M_20</span>)),<span class="fun"></span>(<span class="name">a_7</span>,<span class="var">~M_21</span>))),<span class="fun"></span>(<span class="fun">1-proj-2-tuple</span>(<span class="fun">2-proj-2-tuple</span>(<span class="fun">AES_GCM_dec</span>(<span class="var">~M_26</span>,<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">SALT</span>,<span class="fun">HMAC_SHA256</span>(<span class="var">~M</span>,<span class="fun"></span>(<span class="var">~M_16</span>,<span class="fun"></span>(<span class="name">a_5</span>,<span class="fun"></span>(<span class="fun">btlk</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))),<span class="fun">brle</span>),<span class="fun"></span>(<span class="name">a_6</span>,<span class="var">~M_20</span>)),<span class="fun"></span>(<span class="name">a_7</span>,<span class="var">~M_21</span>)))),<span class="fun"></span>(<span class="fun">1-proj-2-tuple</span>(<span class="fun">2-proj-2-tuple</span>(<span class="fun">2-proj-2-tuple</span>(<span class="fun">AES_GCM_dec</span>(<span class="var">~M_26</span>,<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">SALT</span>,<span class="fun">HMAC_SHA256</span>(<span class="var">~M</span>,<span class="fun"></span>(<span class="var">~M_16</span>,<span class="fun"></span>(<span class="name">a_5</span>,<span class="fun"></span>(<span class="fun">btlk</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))),<span class="fun">brle</span>),<span class="fun"></span>(<span class="name">a_6</span>,<span class="var">~M_20</span>)),<span class="fun"></span>(<span class="name">a_7</span>,<span class="var">~M_21</span>))))),<span class="fun"></span>(<span class="fun">1-proj-2-tuple</span>(<span class="fun">2-proj-2-tuple</span>(<span class="fun">2-proj-2-tuple</span>(<span class="fun">2-proj-2-tuple</span>(<span class="fun">AES_GCM_dec</span>(<span class="var">~M_26</span>,<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">SALT</span>,<span class="fun">HMAC_SHA256</span>(<span class="var">~M</span>,<span class="fun"></span>(<span class="var">~M_16</span>,<span class="fun"></span>(<span class="name">a_5</span>,<span class="fun"></span>(<span class="fun">btlk</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))),<span class="fun">brle</span>),<span class="fun"></span>(<span class="name">a_6</span>,<span class="var">~M_20</span>)),<span class="fun"></span>(<span class="name">a_7</span>,<span class="var">~M_21</span>)))))),<span class="fun"></span>(<span class="fun">1-proj-2-tuple</span>(<span class="fun">2-proj-2-tuple</span>(<span class="fun">2-proj-2-tuple</span>(<span class="fun">2-proj-2-tuple</span>(<span class="fun">2-proj-2-tuple</span>(<span class="fun">AES_GCM_dec</span>(<span class="var">~M_26</span>,<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">SALT</span>,<span class="fun">HMAC_SHA256</span>(<span class="var">~M</span>,<span class="fun"></span>(<span class="var">~M_16</span>,<span class="fun"></span>(<span class="name">a_5</span>,<span class="fun"></span>(<span class="fun">btlk</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))),<span class="fun">brle</span>),<span class="fun"></span>(<span class="name">a_6</span>,<span class="var">~M_20</span>)),<span class="fun"></span>(<span class="name">a_7</span>,<span class="var">~M_21</span>))))))),<span class="name">a_8</span>))))),<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">SALT</span>,<span class="fun">HMAC_SHA256</span>(<span class="var">~M_2</span>,<span class="fun"></span>(<span class="name">a</span>,<span class="fun"></span>(<span class="var">~M_6</span>,<span class="fun"></span>(<span class="fun">btlk</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))),<span class="fun">brle</span>),<span class="fun"></span>(<span class="var">~M_10</span>,<span class="name">a_1</span>)),<span class="fun"></span>(<span class="var">~M_11</span>,<span class="name">a_2</span>)),<span class="name">c_p</span>)) with <span class="fun">AES_GCM_enc</span>(<span class="fun"></span>(<span class="fun">1-proj-2-tuple</span>(<span class="fun">AES_GCM_dec</span>(<span class="var">~M_26</span>,<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">SALT</span>,<span class="fun">HMAC_SHA256</span>(<span class="var">~M</span>,<span class="fun"></span>(<span class="var">~M_16</span>,<span class="fun"></span>(<span class="name">a_5</span>,<span class="fun"></span>(<span class="fun">btlk</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))),<span class="fun">brle</span>),<span class="fun"></span>(<span class="name">a_6</span>,<span class="var">~M_20</span>)),<span class="fun"></span>(<span class="name">a_7</span>,<span class="var">~M_21</span>))),<span class="fun"></span>(<span class="fun">1-proj-2-tuple</span>(<span class="fun">2-proj-2-tuple</span>(<span class="fun">AES_GCM_dec</span>(<span class="var">~M_26</span>,<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">SALT</span>,<span class="fun">HMAC_SHA256</span>(<span class="var">~M</span>,<span class="fun"></span>(<span class="var">~M_16</span>,<span class="fun"></span>(<span class="name">a_5</span>,<span class="fun"></span>(<span class="fun">btlk</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))),<span class="fun">brle</span>),<span class="fun"></span>(<span class="name">a_6</span>,<span class="var">~M_20</span>)),<span class="fun"></span>(<span class="name">a_7</span>,<span class="var">~M_21</span>)))),<span class="fun"></span>(<span class="fun">1-proj-2-tuple</span>(<span class="fun">2-proj-2-tuple</span>(<span class="fun">2-proj-2-tuple</span>(<span class="fun">AES_GCM_dec</span>(<span class="var">~M_26</span>,<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">SALT</span>,<span class="fun">HMAC_SHA256</span>(<span class="var">~M</span>,<span class="fun"></span>(<span class="var">~M_16</span>,<span class="fun"></span>(<span class="name">a_5</span>,<span class="fun"></span>(<span class="fun">btlk</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))),<span class="fun">brle</span>),<span class="fun"></span>(<span class="name">a_6</span>,<span class="var">~M_20</span>)),<span class="fun"></span>(<span class="name">a_7</span>,<span class="var">~M_21</span>))))),<span class="fun"></span>(<span class="fun">1-proj-2-tuple</span>(<span class="fun">2-proj-2-tuple</span>(<span class="fun">2-proj-2-tuple</span>(<span class="fun">2-proj-2-tuple</span>(<span class="fun">AES_GCM_dec</span>(<span class="var">~M_26</span>,<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">SALT</span>,<span class="fun">HMAC_SHA256</span>(<span class="var">~M</span>,<span class="fun"></span>(<span class="var">~M_16</span>,<span class="fun"></span>(<span class="name">a_5</span>,<span class="fun"></span>(<span class="fun">btlk</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))),<span class="fun">brle</span>),<span class="fun"></span>(<span class="name">a_6</span>,<span class="var">~M_20</span>)),<span class="fun"></span>(<span class="name">a_7</span>,<span class="var">~M_21</span>)))))),<span class="fun"></span>(<span class="fun">1-proj-2-tuple</span>(<span class="fun">2-proj-2-tuple</span>(<span class="fun">2-proj-2-tuple</span>(<span class="fun">2-proj-2-tuple</span>(<span class="fun">2-proj-2-tuple</span>(<span class="fun">AES_GCM_dec</span>(<span class="var">~M_26</span>,<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">SALT</span>,<span class="fun">HMAC_SHA256</span>(<span class="var">~M</span>,<span class="fun"></span>(<span class="var">~M_16</span>,<span class="fun"></span>(<span class="name">a_5</span>,<span class="fun"></span>(<span class="fun">btlk</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))),<span class="fun">brle</span>),<span class="fun"></span>(<span class="name">a_6</span>,<span class="var">~M_20</span>)),<span class="fun"></span>(<span class="name">a_7</span>,<span class="var">~M_21</span>))))))),<span class="name">a_8</span>))))),<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">SALT</span>,<span class="fun">HMAC_SHA256</span>(<span class="var">~M_2</span>,<span class="fun"></span>(<span class="name">a</span>,<span class="fun"></span>(<span class="var">~M_6</span>,<span class="fun"></span>(<span class="fun">btlk</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))),<span class="fun">brle</span>),<span class="fun"></span>(<span class="var">~M_10</span>,<span class="name">a_1</span>)),<span class="fun"></span>(<span class="var">~M_11</span>,<span class="name">a_2</span>)) = <span class="fun">AES_GCM_enc</span>(<span class="fun"></span>(<span class="fun">exp</span>(<span class="fun">g</span>,<span class="name">s_</span>),<span class="fun"></span>(<span class="name">r__2</span>,<span class="fun"></span>(<span class="fun">AES_GCM_enc</span>(<span class="name">token_new</span>,<span class="fun">kdf</span>(<span class="fun">kdf</span>(<span class="fun"></span>(<span class="name">SeedS_3</span>,<span class="name">SeedK1_2</span>),<span class="fun">ServerSharedSecret_const</span>),<span class="fun">PairingSession_const</span>),<span class="fun">kdf</span>(<span class="fun">kdf</span>(<span class="fun"></span>(<span class="name">SeedS_3</span>,<span class="name">SeedK1_2</span>),<span class="fun">ServerSharedSecret_const</span>),<span class="fun">PairingSession_const</span>)),<span class="fun"></span>(<span class="name">SeedS_3</span>,<span class="fun"></span>(<span class="fun">sign</span>(<span class="fun"></span>(<span class="name">UUID_2</span>,<span class="fun"></span>(<span class="name">a_3</span>,<span class="fun"></span>(<span class="name">SeedS_3</span>,<span class="fun"></span>(<span class="fun">SHA256</span>(<span class="fun"></span>(<span class="fun">exp</span>(<span class="fun">g</span>,<span class="name">s_</span>),<span class="name">r__2</span>)),<span class="fun"></span>(<span class="name">a_4</span>,<span class="fun">AES_GCM_enc</span>(<span class="name">token_new</span>,<span class="fun">kdf</span>(<span class="fun">kdf</span>(<span class="fun"></span>(<span class="name">SeedS_3</span>,<span class="name">SeedK1_2</span>),<span class="fun">ServerSharedSecret_const</span>),<span class="fun">PairingSession_const</span>),<span class="fun">kdf</span>(<span class="fun">kdf</span>(<span class="fun"></span>(<span class="name">SeedS_3</span>,<span class="name">SeedK1_2</span>),<span class="fun">ServerSharedSecret_const</span>),<span class="fun">PairingSession_const</span>))))))),<span class="fun">qa</span>),<span class="name">a_8</span>))))),<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">SALT</span>,<span class="fun">HMAC_SHA256</span>(<span class="fun">exp</span>(<span class="fun">g</span>,<span class="name">pri_b</span>),<span class="fun"></span>(<span class="name">a</span>,<span class="fun"></span>(<span class="name">nb_2</span>,<span class="fun"></span>(<span class="fun">btlk</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))),<span class="fun">brle</span>),<span class="fun"></span>(<span class="name">skds_2</span>,<span class="name">a_1</span>)),<span class="fun"></span>(<span class="name">ivs_2</span>,<span class="name">a_2</span>)) at <a href="process_1.html#occ74" target="process" class="occ">{74}</a><br>
<br>
<span class="keyword">event</span> <span class="fun">Stepp2</span> at <a href="process_1.html#occ84" target="process" class="occ">{84}</a><br>
<br>
<span class="keyword">new</span> <span class="name">Status_1</span>: <span class="type">bitstring</span> creating <span class="name">Status</span> at <a href="process_1.html#occ86" target="process" class="occ">{86}</a><br>
<br>
<span class="keyword">event</span> <span class="fun">SendSessionNonce</span>(<span class="name">a_3</span>) at <a href="process_1.html#occ88" target="process" class="occ">{88}</a><br>
<br>
<span class="keyword">event</span> <span class="fun">SendE1</span>(<span class="name">a_4</span>) at <a href="process_1.html#occ89" target="process" class="occ">{89}</a><br>
<br>
<span class="keyword">event</span> <span class="fun">SendTokenNew</span>(<span class="name">token_new</span>) at <a href="process_1.html#occ90" target="process" class="occ">{90}</a><br>
<br>
<span class="keyword">out</span>(<span class="name">att</span>, <span class="fun"></span>(<span class="var">~M_28</span>,<span class="var">~M_29</span>)) with <span class="var">~M_28</span> = <span class="fun">AES_GCM_enc</span>(<span class="fun"></span>(<span class="name">s_4</span>,<span class="fun"></span>(<span class="name">r_2</span>,<span class="fun"></span>(<span class="name">UUID_2</span>,<span class="fun"></span>(<span class="name">SN_2</span>,<span class="fun"></span>(<span class="name">a_3</span>,<span class="fun"></span>(<span class="name">a_4</span>,<span class="fun"></span>(<span class="name">token_new</span>,<span class="name">Status</span>))))))),<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">SALT</span>,<span class="fun">HMAC_SHA256</span>(<span class="fun">exp</span>(<span class="fun">g</span>,<span class="name">pri_b</span>),<span class="fun"></span>(<span class="name">a</span>,<span class="fun"></span>(<span class="name">nb_2</span>,<span class="fun"></span>(<span class="fun">btlk</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))),<span class="fun">brle</span>),<span class="fun"></span>(<span class="name">skds_2</span>,<span class="name">a_1</span>)),<span class="fun"></span>(<span class="name">ivs_2</span>,<span class="name">a_2</span>)), <span class="var">~M_29</span> = <span class="name">c_p</span> at <a href="process_1.html#occ91" target="process" class="occ">{91}</a><br>
<br>
<span class="keyword">in</span>(<span class="name">att</span>, <span class="fun"></span>(<span class="fun">AES_GCM_enc</span>(<span class="fun"></span>(<span class="fun">1-proj-2-tuple</span>(<span class="fun">AES_GCM_dec</span>(<span class="var">~M_28</span>,<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">SALT</span>,<span class="fun">HMAC_SHA256</span>(<span class="var">~M_2</span>,<span class="fun"></span>(<span class="name">a</span>,<span class="fun"></span>(<span class="var">~M_6</span>,<span class="fun"></span>(<span class="fun">btlk</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))),<span class="fun">brle</span>),<span class="fun"></span>(<span class="var">~M_10</span>,<span class="name">a_1</span>)),<span class="fun"></span>(<span class="var">~M_11</span>,<span class="name">a_2</span>))),<span class="fun"></span>(<span class="fun">1-proj-2-tuple</span>(<span class="fun">2-proj-2-tuple</span>(<span class="fun">AES_GCM_dec</span>(<span class="var">~M_28</span>,<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">SALT</span>,<span class="fun">HMAC_SHA256</span>(<span class="var">~M_2</span>,<span class="fun"></span>(<span class="name">a</span>,<span class="fun"></span>(<span class="var">~M_6</span>,<span class="fun"></span>(<span class="fun">btlk</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))),<span class="fun">brle</span>),<span class="fun"></span>(<span class="var">~M_10</span>,<span class="name">a_1</span>)),<span class="fun"></span>(<span class="var">~M_11</span>,<span class="name">a_2</span>)))),<span class="name">a_9</span>)),<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">SALT</span>,<span class="fun">HMAC_SHA256</span>(<span class="var">~M</span>,<span class="fun"></span>(<span class="var">~M_16</span>,<span class="fun"></span>(<span class="name">a_5</span>,<span class="fun"></span>(<span class="fun">btlk</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))),<span class="fun">brle</span>),<span class="fun"></span>(<span class="name">a_6</span>,<span class="var">~M_20</span>)),<span class="fun"></span>(<span class="name">a_7</span>,<span class="var">~M_21</span>)),<span class="name">c_p</span>)) with <span class="fun">AES_GCM_enc</span>(<span class="fun"></span>(<span class="fun">1-proj-2-tuple</span>(<span class="fun">AES_GCM_dec</span>(<span class="var">~M_28</span>,<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">SALT</span>,<span class="fun">HMAC_SHA256</span>(<span class="var">~M_2</span>,<span class="fun"></span>(<span class="name">a</span>,<span class="fun"></span>(<span class="var">~M_6</span>,<span class="fun"></span>(<span class="fun">btlk</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))),<span class="fun">brle</span>),<span class="fun"></span>(<span class="var">~M_10</span>,<span class="name">a_1</span>)),<span class="fun"></span>(<span class="var">~M_11</span>,<span class="name">a_2</span>))),<span class="fun"></span>(<span class="fun">1-proj-2-tuple</span>(<span class="fun">2-proj-2-tuple</span>(<span class="fun">AES_GCM_dec</span>(<span class="var">~M_28</span>,<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">SALT</span>,<span class="fun">HMAC_SHA256</span>(<span class="var">~M_2</span>,<span class="fun"></span>(<span class="name">a</span>,<span class="fun"></span>(<span class="var">~M_6</span>,<span class="fun"></span>(<span class="fun">btlk</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))),<span class="fun">brle</span>),<span class="fun"></span>(<span class="var">~M_10</span>,<span class="name">a_1</span>)),<span class="fun"></span>(<span class="var">~M_11</span>,<span class="name">a_2</span>)))),<span class="name">a_9</span>)),<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">SALT</span>,<span class="fun">HMAC_SHA256</span>(<span class="var">~M</span>,<span class="fun"></span>(<span class="var">~M_16</span>,<span class="fun"></span>(<span class="name">a_5</span>,<span class="fun"></span>(<span class="fun">btlk</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))),<span class="fun">brle</span>),<span class="fun"></span>(<span class="name">a_6</span>,<span class="var">~M_20</span>)),<span class="fun"></span>(<span class="name">a_7</span>,<span class="var">~M_21</span>)) = <span class="fun">AES_GCM_enc</span>(<span class="fun"></span>(<span class="name">s_4</span>,<span class="fun"></span>(<span class="name">r_2</span>,<span class="name">a_9</span>)),<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">SALT</span>,<span class="fun">HMAC_SHA256</span>(<span class="fun">exp</span>(<span class="fun">g</span>,<span class="name">pri_a</span>),<span class="fun"></span>(<span class="name">na_2</span>,<span class="fun"></span>(<span class="name">a_5</span>,<span class="fun"></span>(<span class="fun">btlk</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))),<span class="fun">brle</span>),<span class="fun"></span>(<span class="name">a_6</span>,<span class="name">skdm_2</span>)),<span class="fun"></span>(<span class="name">a_7</span>,<span class="name">ivm_2</span>)) at <a href="process_1.html#occ144" target="process" class="occ">{144}</a><br>
<br>
<span class="keyword">event</span> <span class="fun">Stepc2</span> at <a href="process_1.html#occ152" target="process" class="occ">{152}</a><br>
<br>
<span class="keyword">out</span>(<span class="name">sec_ch</span>, <span class="fun"></span>(<span class="fun">get_id</span>(<span class="fun">add</span>(<span class="fun">exp</span>(<span class="fun">g</span>,<span class="name">s_4</span>),<span class="fun">exp</span>(<span class="fun">g</span>,<span class="name">s_</span>)),<span class="fun"></span>(<span class="name">r_2</span>,<span class="name">r__2</span>)),<span class="name">id_c</span>)) at <a href="process_1.html#occ153" target="process" class="occ">{153}</a> received at <a href="process_1.html#occ154" target="process" class="occ">{154}</a><br>
<br>
<span class="keyword">out</span>(<span class="name">sec_ch</span>, <span class="fun"></span>(<span class="fun">get_id</span>(<span class="fun">add</span>(<span class="fun">exp</span>(<span class="fun">g</span>,<span class="name">s_4</span>),<span class="fun">exp</span>(<span class="fun">g</span>,<span class="name">s_</span>)),<span class="fun"></span>(<span class="name">r_2</span>,<span class="name">r__2</span>)),<span class="name">id_p</span>)) at <a href="process_1.html#occ94" target="process" class="occ">{94}</a> received at <a href="process_1.html#occ155" target="process" class="occ">{155}</a><br>
<br>
<span class="keyword">out</span>(<span class="name">sec_ch</span>, <span class="fun"></span>(<span class="fun">yes_confirm_const</span>,<span class="name">user_ui</span>)) at <a href="process_1.html#occ157" target="process" class="occ">{157}</a> received at <a href="process_1.html#occ95" target="process" class="occ">{95}</a><br>
<br>
<span class="keyword">event</span> <span class="fun">PairSuccess</span>(<span class="fun">get_id</span>(<span class="fun">add</span>(<span class="fun">exp</span>(<span class="fun">g</span>,<span class="name">s_4</span>),<span class="fun">exp</span>(<span class="fun">g</span>,<span class="name">s_</span>)),<span class="fun"></span>(<span class="name">r_2</span>,<span class="name">r__2</span>)),<span class="fun">get_id</span>(<span class="fun">add</span>(<span class="fun">exp</span>(<span class="fun">g</span>,<span class="name">s_4</span>),<span class="fun">exp</span>(<span class="fun">g</span>,<span class="name">s_</span>)),<span class="fun"></span>(<span class="name">r_2</span>,<span class="name">r__2</span>))) at <a href="process_1.html#occ158" target="process" class="occ">{158}</a><br>
<br>
<span class="keyword">new</span> <span class="name">tmp_1</span>: <span class="type">bitstring</span> creating <span class="name">tmp</span> at <a href="process_1.html#occ97" target="process" class="occ">{97}</a><br>
<br>
<span class="keyword">out</span>(<span class="name">att</span>, <span class="fun"></span>(<span class="var">~M_30</span>,<span class="fun"></span>(<span class="var">~M_31</span>,<span class="var">~M_32</span>))) with <span class="var">~M_30</span> = <span class="name">tmp</span>, <span class="var">~M_31</span> = <span class="fun">AES_GCM_enc</span>(<span class="fun">sv</span>,<span class="fun">get_id</span>(<span class="fun">add</span>(<span class="fun">exp</span>(<span class="fun">g</span>,<span class="name">s_4</span>),<span class="fun">exp</span>(<span class="fun">g</span>,<span class="name">s_</span>)),<span class="fun"></span>(<span class="name">r_2</span>,<span class="name">r__2</span>)),<span class="name">tmp</span>), <span class="var">~M_32</span> = <span class="name">open_ch</span> at <a href="process_1.html#occ98" target="process" class="occ">{98}</a><br>
<br>
<span class="keyword">event</span> <span class="fun">Secret</span>(<span class="fun">sv</span>) at <a href="process_1.html#occ99" target="process" class="occ">{99}</a><br>
<br>
The attacker has the message <span class="fun">AES_GCM_dec</span>(<span class="var">~M_31</span>,<span class="fun">get_id</span>(<span class="fun">add</span>(<span class="fun">exp</span>(<span class="fun">g</span>,<span class="fun">1-proj-2-tuple</span>(<span class="fun">AES_GCM_dec</span>(<span class="var">~M_28</span>,<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">SALT</span>,<span class="fun">HMAC_SHA256</span>(<span class="var">~M_2</span>,<span class="fun"></span>(<span class="name">a</span>,<span class="fun"></span>(<span class="var">~M_6</span>,<span class="fun"></span>(<span class="fun">btlk</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))),<span class="fun">brle</span>),<span class="fun"></span>(<span class="var">~M_10</span>,<span class="name">a_1</span>)),<span class="fun"></span>(<span class="var">~M_11</span>,<span class="name">a_2</span>)))),<span class="fun">1-proj-2-tuple</span>(<span class="fun">AES_GCM_dec</span>(<span class="var">~M_26</span>,<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">SALT</span>,<span class="fun">HMAC_SHA256</span>(<span class="var">~M</span>,<span class="fun"></span>(<span class="var">~M_16</span>,<span class="fun"></span>(<span class="name">a_5</span>,<span class="fun"></span>(<span class="fun">btlk</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))),<span class="fun">brle</span>),<span class="fun"></span>(<span class="name">a_6</span>,<span class="var">~M_20</span>)),<span class="fun"></span>(<span class="name">a_7</span>,<span class="var">~M_21</span>)))),<span class="fun"></span>(<span class="fun">1-proj-2-tuple</span>(<span class="fun">2-proj-2-tuple</span>(<span class="fun">AES_GCM_dec</span>(<span class="var">~M_28</span>,<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">SALT</span>,<span class="fun">HMAC_SHA256</span>(<span class="var">~M_2</span>,<span class="fun"></span>(<span class="name">a</span>,<span class="fun"></span>(<span class="var">~M_6</span>,<span class="fun"></span>(<span class="fun">btlk</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))),<span class="fun">brle</span>),<span class="fun"></span>(<span class="var">~M_10</span>,<span class="name">a_1</span>)),<span class="fun"></span>(<span class="var">~M_11</span>,<span class="name">a_2</span>)))),<span class="fun">1-proj-2-tuple</span>(<span class="fun">2-proj-2-tuple</span>(<span class="fun">AES_GCM_dec</span>(<span class="var">~M_26</span>,<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">AES_CMAC</span>(<span class="fun">SALT</span>,<span class="fun">HMAC_SHA256</span>(<span class="var">~M</span>,<span class="fun"></span>(<span class="var">~M_16</span>,<span class="fun"></span>(<span class="name">a_5</span>,<span class="fun"></span>(<span class="fun">btlk</span>,<span class="fun"></span>(<span class="fun">addr_A</span>,<span class="fun">addr_B</span>)))))),<span class="fun">brle</span>),<span class="fun"></span>(<span class="name">a_6</span>,<span class="var">~M_20</span>)),<span class="fun"></span>(<span class="name">a_7</span>,<span class="var">~M_21</span>)))))),<span class="var">~M_30</span>) = <span class="fun">sv</span>.<br>
A trace has been found.<br>
</body>
</html>
